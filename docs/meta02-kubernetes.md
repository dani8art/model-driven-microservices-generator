# METAMODEL 02: Kubernetes

This metamodel represents the kubernetes deployment model and it is generated by
[Model2Model]() transformation that will get the [METAMODEL 01]() as input and return
METAMODEL 02. Kubernetes metamodel will be used by [Model2Text]() transformation for
generating all files necessary.

**Samples of intances**

- [Example 01: Pets](./images/example01-pets-kube.png)
- [Example 02: >name<](./images/example01-pets-kube.png)

![metamodel 02: kubernetes](./images/metamodel02-kubernetes-v2.png)

There are eight important classes on this metamodel `Kubernetes`, `Service`, `Deployment`,
 `Container`, `EnvironmentVar`, `Label`, `ServiceType` and `CloudType`.

### Kubernetes

This class is the root of metamodel.

Property | Type | Description
------------ | ------------- | ----------
cloud        | `CloudType` | **Required**. This property defined where will be deployed the application. Its value will be `LOCAL` by default, you will have the possibility of using `minikube` to deploy.

##### Restrictions

1. Can't there are two services with the same name.
2. Can't there are two services with the same port.

### Service

This class represents the service concepts of kubernetes. A Kubernetes Service is an abstraction layer which defines a logical set of Pods and enables external traffic exposure, load balancing and service discovery for those Pods.

Property | Type | Description
------------ | ------------- | ----------
name        | `string` | **Required**. The name of the service.
type        | `ServiceType` | **Required**. Type of service.
port        | `integer` | **Required**. Port where the service will be exposed for external traffic.
targetPort        | `integer` | **Required**. Port that will be targeted on the containers that are included into the related deployment.

##### Restrictions

1. If `kubernetes.cloud == LOCAL` then type can not be `LoadBalancer`.

### Deployment

This class represents the deployment concepts of kubernetes. A Deployment is a next generation of Replication Controllers which ensures that a specified number of pod “replicas” are running at any one time. In other words, a replication controller makes sure that a pod or homogeneous set of pods are always up and available.

Property | Type | Description
------------ | ------------- | ----------
replicas        | `integer` | **Required**. The number of pod that you want to be maintained by the deployment.

##### Restrictions

1. The property `replicas` must be greater or equal to 1.
2. One Deployment can't have two containers with the same `containerPort`.
3. One Deployment can't have two containers with the same `name`.
4. One Deployment can't have two label with the same `key`.

### Container

This class represents the description and configuration of ours containers.

Property | Type | Description
------------ | ------------- | ----------
name        | `string` | **Required**. The name of the container.
image        | `integer` | **Required**. Container will be created from this docker image.
containerPort | `integer` | **Required**. Port where the application is exposed into the container.

##### Restrictions

1. One container can't have two EnvironmentVars with the same `name`.

### EnvironmentVar

This class represents the environment variables which will be passed to the container and it will configure the application.

Property | Type | Description
------------ | ------------- | ----------
name        | `string` | **Required**. The name of the environment variable.
value        | `integer` | **Required**. The value of the environment variable.


### Label

This class represents the label concepts of kubernetes. Labels are key/value pairs that are attached to objects, such as pods. We’ll eventually index and reverse-index labels for efficient queries and watches and the main objective of this concepts is to be an identifier which will be used by service to find deployments that it will balance.

Property | Type | Description
------------ | ------------- | ----------
key        | `string` | **Required**. The key of the label.
value        | `integer` | **Required**. The value of the label.
